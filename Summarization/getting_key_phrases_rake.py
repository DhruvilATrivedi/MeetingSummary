# -*- coding: utf-8 -*-
"""Getting_Key_Phrases_RAKE.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1pRL4hb54HO-ZmG59d32tALcdPF6tcwNe
"""

pip install rake_nltk

#Importing libraries
import pandas as pd
from rake_nltk import Rake

from google.colab import drive
drive.mount("/content/drive")

#Reading the csv file
df = pd.read_csv("/content/drive/My Drive/MeetingSummary/simpsons_dataset.csv")
print(df)

type(df.spoken_words[0])

len(df)

#Checking presence of blank rows
df.isnull().sum()

#Droping blank rows
df.dropna(inplace=True)

len(df)

df.reset_index(inplace=True)
df.drop(['index'], axis=1)

df.isnull().sum()

#Taking 3600 rows for testing
test_df = df.iloc[:3600]
test_df

#Joining the texts
text = ' '.join(df["spoken_words"])
text

#Cresting a dictionary for abbreviation
abbreviation_mapping = {"ain't": "is not", "aren't": "are not","can't": "cannot", "'cause": "because", "could've": "could have", "couldn't": "could not",
                         
                           "didn't": "did not", "doesn't": "does not", "don't": "do not", "hadn't": "had not", "hasn't": "has not", "haven't": "have not",

                           "he'd": "he would","he'll": "he will", "he's": "he is", "how'd": "how did", "how'd'y": "how do you", "how'll": "how will", "how's": "how is",

                           "I'd": "I would", "I'd've": "I would have", "I'll": "I will", "I'll've": "I will have","I'm": "I am", "I've": "I have", "i'd": "i would",

                           "i'd've": "i would have", "i'll": "i will",  "i'll've": "i will have","i'm": "i am", "i've": "i have", "isn't": "is not", "it'd": "it would",

                           "it'd've": "it would have", "it'll": "it will", "it'll've": "it will have","it's": "it is", "let's": "let us", "ma'am": "madam",

                           "mayn't": "may not", "might've": "might have","mightn't": "might not","mightn't've": "might not have", "must've": "must have",

                           "mustn't": "must not", "mustn't've": "must not have", "needn't": "need not", "needn't've": "need not have","o'clock": "of the clock",

                           "oughtn't": "ought not", "oughtn't've": "ought not have", "shan't": "shall not", "sha'n't": "shall not", "shan't've": "shall not have",

                           "she'd": "she would", "she'd've": "she would have", "she'll": "she will", "she'll've": "she will have", "she's": "she is",

                           "should've": "should have", "shouldn't": "should not", "shouldn't've": "should not have", "so've": "so have","so's": "so as",

                           "this's": "this is","that'd": "that would", "that'd've": "that would have", "that's": "that is", "there'd": "there would",

                           "there'd've": "there would have", "there's": "there is", "here's": "here is","they'd": "they would", "they'd've": "they would have",

                           "they'll": "they will", "they'll've": "they will have", "they're": "they are", "they've": "they have", "to've": "to have",

                           "wasn't": "was not", "we'd": "we would", "we'd've": "we would have", "we'll": "we will", "we'll've": "we will have", "we're": "we are",

                           "we've": "we have", "weren't": "were not", "what'll": "what will", "what'll've": "what will have", "what're": "what are",

                           "what's": "what is", "what've": "what have", "when's": "when is", "when've": "when have", "where'd": "where did", "where's": "where is",

                           "where've": "where have", "who'll": "who will", "who'll've": "who will have", "who's": "who is", "who've": "who have",

                           "why's": "why is", "why've": "why have", "will've": "will have", "won't": "will not", "won't've": "will not have",

                           "would've": "would have", "wouldn't": "would not", "wouldn't've": "would not have", "y'all": "you all",

                           "y'all'd": "you all would","y'all'd've": "you all would have","y'all're": "you all are","y'all've": "you all have",

                           "you'd": "you would", "you'd've": "you would have", "you'll": "you will", "you'll've": "you will have",

                           "you're": "you are", "you've": "you have"}

#Cleaning text for abbreviations
cleaned_text = text
cleaned_text = ' '.join([abbreviation_mapping[t] if t in abbreviation_mapping else t for t in cleaned_text.split(" ")]) 
cleaned_text

#Creating a stoplist
stoplist = ['amongst',
 'who',
 'you',
 'where',
 'becoming',
 'least',
 'twenty',
 'will',
 'call',
 'always',
 'hasnt',
 'which',
 'when',
 'something',
 'bill',
 'under',
 'is',
 'nowhere',
 'same',
 'almost',
 'first',
 'onto',
 'afterwards',
 'serious',
 'co',
 'either',
 'inc',
 'sometime',
 'myself',
 'am',
 'together',
 'etc',
 'perhaps',
 'down',
 'twelve',
 'are',
 'neither',
 'mine',
 'were',
 'then',
 'well',
 'without',
 'yours',
 'been',
 'after',
 'all',
 'his',
 'most',
 'else',
 'give',
 'must',
 'not',
 'take',
 'anyway',
 'those',
 'amount',
 'full',
 'less',
 'eight',
 'see',
 'hence',
 'than',
 'though',
 'very',
 'her',
 'name',
 'whatever',
 'do',
 'enough',
 'there',
 'nine',
 'so',
 'anyhow',
 'bottom',
 'him',
 'had',
 'last',
 'nothing',
 'above',
 'anything',
 'found',
 'elsewhere',
 'one',
 'six',
 'sixty',
 'some',
 'ten',
 'whereafter',
 'whom',
 'noone',
 'per',
 'in',
 'keep',
 'show',
 'alone',
 'among',
 'cannot',
 'mostly',
 'or',
 'whereupon',
 'back',
 'describe',
 'de',
 'even',
 'he',
 'their',
 'this',
 'side',
 'ltd',
 'it',
 'others',
 'also',
 'four',
 'hereby',
 'cry',
 'made',
 'a',
 'hereupon',
 'everyone',
 'put',
 'and',
 'into',
 'the',
 'any',
 'have',
 'move',
 'throughout',
 'along',
 'may',
 'but',
 'ever',
 'beside',
 'namely',
 'its',
 'we',
 'while',
 'herein',
 'other',
 'more',
 'sincere',
 'fifty',
 'front',
 'seems',
 'already',
 'for',
 'us',
 're',
 'them',
 'off',
 'wherever',
 'another',
 'fire',
 'thereupon',
 'would',
 'by',
 'around',
 'find',
 'these',
 'within',
 'forty',
 'over',
 'himself',
 'she',
 'what',
 'becomes',
 'thereby',
 'due',
 'here',
 'i',
 'several',
 'that',
 'done',
 'nobody',
 'through',
 'too',
 'system',
 'otherwise',
 'could',
 'before',
 'everything',
 'everywhere',
 'amoungst',
 'many',
 'seeming',
 'with',
 'upon',
 'your',
 'yourself',
 'often',
 'yourselves',
 'because',
 'sometimes',
 'five',
 'empty',
 'nor',
 'ie',
 'was',
 'should',
 'eleven',
 'own',
 'thereafter',
 'detail',
 'hundred',
 'out',
 'next',
 'thru',
 'until',
 'on',
 'whole',
 'why',
 'wherein',
 'fill',
 'yet',
 'across',
 'once',
 'my',
 'top',
 'via',
 'both',
 'nevertheless',
 'from',
 'meanwhile',
 'whoever',
 'of',
 'ours',
 'thence',
 'to',
 'themselves',
 'anyone',
 'our',
 'towards',
 'thick',
 'moreover',
 'can',
 'between',
 'if',
 'therefore',
 'fifteen',
 'hers',
 'latter',
 'seem',
 'being',
 'go',
 'never',
 'only',
 'below',
 'thus',
 'anywhere',
 'again',
 'interest',
 'someone',
 'part',
 'since',
 'latterly',
 'herself',
 'during',
 'although',
 'beyond',
 'none',
 'formerly',
 'former',
 'beforehand',
 'me',
 'mill',
 'about',
 'third',
 'rather',
 'now',
 'toward',
 'whose',
 'get',
 'whether',
 'as',
 'eg',
 'behind',
 'indeed',
 'itself',
 'con',
 'every',
 'whence',
 'seemed',
 'besides',
 'they',
 'further',
 'be',
 'two',
 'at',
 'however',
 'no',
 'still',
 'ourselves',
 'thin',
 'whenever',
 'whereas',
 'cant',
 'has',
 'might',
 'such',
 'an',
 'much',
 'except',
 'how',
 'therein',
 'un',
 'each',
 'couldnt',
 'somewhere',
 'whereby',
 'whither',
 'few',
 'somehow',
 'up',
 'three',
 'hereafter',
 'became',
 'become',
 'please',
 'against',
 '',
 "aren't",
 "can't",
 "couldn't",
 'did',
 "didn't",
 'does',
 "doesn't",
 'doing',
 "don't",
 "hadn't",
 "hasn't",
 "haven't",
 'having',
 "he'd",
 "he'll",
 "he's",
 "here's",
 "how's",
 "i'd",
 "i'll",
 "i'm",
 "i've",
 "isn't",
 "it's",
 "let's",
 "mustn't",
 'ought',
 'ours\tourselves',
 "shan't",
 "she'd",
 "she'll",
 "she's",
 "shouldn't",
 "that's",
 'theirs',
 "there's",
 "they'd",
 "they'll",
 "they're",
 "they've",
 "wasn't",
 "we'd",
 "we'll",
 "we're",
 "we've",
 "weren't",
 "what's",
 "when's",
 "where's",
 "who's",
 "why's",
 "won't",
 "wouldn't",
 "you'd",
 "you'll",
 "you're",
 "you've",
 "a's",
 'able',
 'according',
 'accordingly',
 'actually',
 "ain't",
 'allow',
 'allows',
 'anybody',
 'anyways',
 'apart',
 'appear',
 'appreciate',
 'appropriate',
 'aside',
 'ask',
 'asking',
 'associated',
 'available',
 'away',
 'awfully',
 'b',
 'believe',
 'best',
 'better',
 'brief',
 'c',
 "c'mon",
 "c's",
 'came',
 'cause',
 'causes',
 'certain',
 'certainly',
 'changes',
 'clearly',
 'com',
 'come',
 'comes',
 'concerning',
 'consequently',
 'consider',
 'considering',
 'contain',
 'containing',
 'contains',
 'corresponding',
 'course',
 'currently',
 'd',
 'definitely',
 'described',
 'despite',
 'different',
 'downwards',
 'e',
 'edu',
 'entirely',
 'especially',
 'et',
 'everybody',
 'ex',
 'exactly',
 'example',
 'f',
 'far',
 'fifth',
 'followed',
 'following',
 'follows',
 'forth',
 'furthermore',
 'g',
 'gets',
 'getting',
 'given',
 'gives',
 'goes',
 'going',
 'gone',
 'got',
 'gotten',
 'greetings',
 'h',
 'happens',
 'hardly',
 'hello',
 'help',
 'hi',
 'hither',
 'hopefully',
 'howbeit',
 'ignored',
 'immediate',
 'inasmuch',
 'indicate',
 'indicated',
 'indicates',
 'inner',
 'insofar',
 'instead',
 'inward',
 "it'd",
 "it'll",
 'j',
 'just',
 'k',
 'keeps',
 'kept',
 'know',
 'knows',
 'known',
 'l',
 'lately',
 'later',
 'lest',
 'let',
 'like',
 'liked',
 'likely',
 'little',
 'look',
 'looking',
 'looks',
 'm',
 'mainly',
 'maybe',
 'mean',
 'merely',
 'n',
 'nd',
 'near',
 'nearly',
 'necessary',
 'need',
 'needs',
 'new',
 'non',
 'normally',
 'novel',
 'o',
 'obviously',
 'oh',
 'ok',
 'okay',
 'old',
 'ones',
 'outside',
 'overall',
 'p',
 'particular',
 'particularly',
 'placed',
 'plus',
 'possible',
 'presumably',
 'probably',
 'provides',
 'q',
 'que',
 'quite',
 'qv',
 'r',
 'rd',
 'really',
 'reasonably',
 'regarding',
 'regardless',
 'regards',
 'relatively',
 'respectively',
 'right',
 's',
 'said',
 'saw',
 'say',
 'saying',
 'says',
 'second',
 'secondly',
 'seeing',
 'seen',
 'self',
 'selves',
 'sensible',
 'sent',
 'seriously',
 'seven',
 'shall',
 'somebody',
 'somewhat',
 'soon',
 'sorry',
 'specified',
 'specify',
 'specifying',
 'sub',
 'sup',
 'sure',
 't',
 "t's",
 'taken',
 'tell',
 'tends',
 'th',
 'thank',
 'thanks',
 'thanx',
 'thats',
 'theres',
 'think',
 'thorough',
 'thoroughly',
 'took',
 'tried',
 'tries',
 'truly',
 'try',
 'trying',
 'twice',
 'u',
 'unfortunately',
 'unless',
 'unlikely',
 'unto',
 'use',
 'used',
 'useful',
 'uses',
 'using',
 'usually',
 'uucp',
 'v',
 'value',
 'various',
 'viz',
 'vs',
 'w',
 'want',
 'wants',
 'way',
 'welcome',
 'went',
 'willing',
 'wish',
 'wonder',
 'x',
 'y',
 'yes',
 'z',
 'zero']

#Applying Rake algorithm for specific stopwords
r = Rake(stopwords=stoplist)

#Generating phrase list and ranked phrase list by applying RAKE algorithm
key_words = r.extract_keywords_from_text(cleaned_text)
phrase_list = r.get_ranked_phrases()
ranked_phrase_list = r.get_ranked_phrases_with_scores()
ranked_phrase_list

len(ranked_phrase_list)

len(phrase_list)